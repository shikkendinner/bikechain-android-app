{"files":[{"id":"5277cb07-9017-450c-8daf-c2fc0e64031d","name":"Code","type":"server_js","source":"function updateEveryone(e) {\n  var ids \u003d removeDuplicates();\n  ids.shift();\n  \n  if(ids.length !\u003d 0){\n    \n    var regIDS \u003d [];\n    \n    for(i in ids){\n      regIDS.push(ids[i][0]);\n    }\n    \n    var url \u003d \"https://android.googleapis.com/gcm/send\";\n    var apiKey \u003d \"AIzaSyAtllCc3-dKpDxZpzk-_6I48CCSK5eWct4\";\n    \n    var payload \u003d { \"registration_ids\" : regIDS,\n                   \"data\" : {\n                     \"message\" : \"update\" }\n                  };\n    \n    var params \u003d { \"contentType\" : \"application/json\",\n                  \"headers\" : {\"Authorization\" : \"key\u003d\" + apiKey},\n                  \"method\" : \"post\",\n                  \"payload\" : JSON.stringify(payload) };\n      \n    var response \u003d UrlFetchApp.fetch(url, params).getContentText();\n    Logger.log(response);\n  } else Logger.log(\"NOTHING IN HERE\");\n}\n\nfunction setInstallableTrigger(){\n  var spreadSheet \u003d SpreadsheetApp.openById(\"1qVqKnKlg8il6zJ6xzs0Ut4hA-DLqFAbTvYykM_tEYdk\");\n  \n  ScriptApp.newTrigger(\"updateEveryone\").forSpreadsheet(spreadSheet).onEdit().create();\n  ScriptApp.newTrigger(\"updateEveryone\").forSpreadsheet(spreadSheet).onFormSubmit().create();\n}\n\nfunction clearRegistrationIDS(){\n  var spreadSheet \u003d SpreadsheetApp.openById(\"1b6m_1BGDHOjsGHocM3nLw1FgSuLaM3x9ODr3Vs0zaU8\").getSheets()[0];\n  spreadSheet.clearContents();\n  spreadSheet.appendRow([\"IDs\"]);\n}\n\nfunction removeDuplicates() {\n  var sheet \u003d SpreadsheetApp.openById(\"1b6m_1BGDHOjsGHocM3nLw1FgSuLaM3x9ODr3Vs0zaU8\").getSheets()[0];\n  var data \u003d sheet.getDataRange().getValues();\n  var newData \u003d new Array();\n  for(i in data){\n    var row \u003d data[i];\n    var duplicate \u003d false;\n    for(j in newData){\n      if(row.join() \u003d\u003d newData[j].join()){\n        duplicate \u003d true;\n      }\n    }\n    if(!duplicate){\n      newData.push(row);\n    }\n  }\n  sheet.clearContents();\n  sheet.getRange(1, 1, newData.length, newData[0].length).setValues(newData);\n  \n  return newData;\n}\n"}]}